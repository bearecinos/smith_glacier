# smith_glacier

Experiments with [Fenics_ice](https://github.com/EdiGlacUQ/fenics_ice) over Smith, Pope, and Kohler Glaciers. They are three narrow âˆ¼ 10 km wide, interconnected West Antarctic ice streams.

> This repository and its documentation is a work in progress...

The code has been developed to: 

1. Create a finite element mesh for the region of interest where simulations will be carried out.
2. Generate the all input data (crop to the study domain) needed by Fenics_ice.

And also to carry out the following experiments with the model:

3. Invert for basal drag and ice stiffness by minimizing the difference between model and observed ice velocities.
4. Run the eigendecomposition of the Hessian matrix of the model-observations mistfit. This will allow us to multpli by the inverse of the covariance matrix of the basal drag/ice stiffness. 
5. Then the model will project the covariance on a linearization of the time-dependent ice sheet model (again using Automatic Differentiation to generate the linearization) to estimate the growth of QoI uncertainty over time (e.g. QoI is the ice mass loss).


Repository structure:

[![](https://mermaid.ink/img/eyJjb2RlIjoiXG5ncmFwaCBMUjtcbiAgICBSZXBvc2l0b3J5IC0tPiBtZXNodG9vbHM7XG4gICAgUmVwb3NpdG9yeSAtLT4gc2NyaXB0cztcbiAgICBSZXBvc2l0b3J5IC0tPiBjb25maWcuaW5pdDtcbiAgICBSZXBvc2l0b3J5IC0tPiBzZXRwYXRocy5zaDtcblx0XHRcbiAgICBtZXNodG9vbHMgLS0-ICBpZDFbXCJBIHNldCBvZiB0b29scyBmb3IgbWVzaCBhbmQgaW5wdXQgZGF0YSBnZW5lcmF0aW9uLlwiXTtcbiAgICBzY3JpcHRzIC0tPiBpZDJbXCJQeXRob24gYW5kIGJhc2ggc2NyaXB0cyB0byBydW4gZWFjaCBkYXRhIHByb2Nlc3Npbmcgc3RhZ2UuXCJdO1xuICAgIGNvbmZpZy5pbml0IC0tPiBpZDRbXCJDb25maWd1cmF0aW9uIGZpbGUgZm9yIHBhdGhzIHRvIGlucHV0IGFuZCBvdXRwdXQgZGF0YS5cIl07XG4gICAgc2V0cGF0aHMuc2ggLS0-IGlkNVtcIkdsb2JhbCBwYXRocyB0byByZXBvc2l0b3J5IGFuZCByZXBvc2l0b3J5IGRpcmVjdG9yaWVzLlwiXTtcblxuICAgIHN0eWxlIFJlcG9zaXRvcnkgZmlsbDojZmZmZmZmLHN0cm9rZTojMzMzLHN0cm9rZS13aWR0aDoxcHgsZm9udC1zaXplOjE4cHgsZm9udC13ZWlnaHQ6NTAwLHRleHQtYWxpZ246IGNlbnRlclxuICAgIHN0eWxlIG1lc2h0b29scyBmaWxsOiNmZmZmZmYsc3Ryb2tlOiMzMzMsc3Ryb2tlLXdpZHRoOjFweCxmb250LXNpemU6MThweCxmb250LXdlaWdodDo1MDAsdGV4dC1hbGlnbjogY2VudGVyXG4gICAgc3R5bGUgY29uZmlnLmluaXQgZmlsbDojZmZmZmZmLHN0cm9rZTojMzMzLHN0cm9rZS13aWR0aDoxcHgsZm9udC1zaXplOjE4cHgsZm9udC13ZWlnaHQ6NTAwLHRleHQtYWxpZ246IGNlbnRlclxuICAgIHN0eWxlIHNjcmlwdHMgZmlsbDojZmZmZmZmLHN0cm9rZTojMzMzLHN0cm9rZS13aWR0aDoxcHgsZm9udC1zaXplOjE4cHgsZm9udC13ZWlnaHQ6NTAwLHRleHQtYWxpZ246IGNlbnRlclxuICAgIHN0eWxlIHNldHBhdGhzLnNoIGZpbGw6I2ZmZmZmZixzdHJva2U6IzMzMyxzdHJva2Utd2lkdGg6MXB4LGZvbnQtc2l6ZToxOHB4LGZvbnQtd2VpZ2h0OjUwMCx0ZXh0LWFsaWduOiBjZW50ZXJcbiAgICAgXG4gICAgIiwibWVybWFpZCI6eyJkaWFncmFtTWFyZ2luWCI6NTAsImRpYWdyYW1NYXJnaW5ZIjoxMCwiYm94VGV4dE1hcmdpbiI6NSwibm90ZU1hcmdpbiI6MTAsIm1lc3NhZ2VNYXJnaW4iOjM1LCJtaXJyb3JBY3RvcnMiOnRydWUsInRoZW1lIjoiZGVmYXVsdCJ9LCJ1cGRhdGVFZGl0b3IiOmZhbHNlLCJhdXRvU3luYyI6dHJ1ZSwidXBkYXRlRGlhZ3JhbSI6ZmFsc2V9)](https://mermaid-js.github.io/mermaid-live-editor/edit#eyJjb2RlIjoiXG5ncmFwaCBMUjtcbiAgICBSZXBvc2l0b3J5IC0tPiBtZXNodG9vbHM7XG4gICAgUmVwb3NpdG9yeSAtLT4gc2NyaXB0cztcbiAgICBSZXBvc2l0b3J5IC0tPiBjb25maWcuaW5pdDtcbiAgICBSZXBvc2l0b3J5IC0tPiBzZXRwYXRocy5zaDtcblx0XHRcbiAgICBtZXNodG9vbHMgLS0-ICBpZDFbXCJBIHNldCBvZiB0b29scyBmb3IgbWVzaCBhbmQgaW5wdXQgZGF0YSBnZW5lcmF0aW9uLlwiXTtcbiAgICBzY3JpcHRzIC0tPiBpZDJbXCJQeXRob24gYW5kIGJhc2ggc2NyaXB0cyB0byBydW4gZWFjaCBkYXRhIHByb2Nlc3Npbmcgc3RhZ2UuXCJdO1xuICAgIGNvbmZpZy5pbml0IC0tPiBpZDRbXCJDb25maWd1cmF0aW9uIGZpbGUgZm9yIHBhdGhzIHRvIGlucHV0IGFuZCBvdXRwdXQgZGF0YS5cIl07XG4gICAgc2V0cGF0aHMuc2ggLS0-IGlkNVtcIkdsb2JhbCBwYXRocyB0byByZXBvc2l0b3J5IGFuZCByZXBvc2l0b3J5IGRpcmVjdG9yaWVzLlwiXTtcblxuICAgIHN0eWxlIFJlcG9zaXRvcnkgZmlsbDojZmZmZmZmLHN0cm9rZTojMzMzLHN0cm9rZS13aWR0aDoxcHgsZm9udC1zaXplOjE4cHgsZm9udC13ZWlnaHQ6NTAwLHRleHQtYWxpZ246IGNlbnRlclxuICAgIHN0eWxlIG1lc2h0b29scyBmaWxsOiNmZmZmZmYsc3Ryb2tlOiMzMzMsc3Ryb2tlLXdpZHRoOjFweCxmb250LXNpemU6MThweCxmb250LXdlaWdodDo1MDAsdGV4dC1hbGlnbjogY2VudGVyXG4gICAgc3R5bGUgY29uZmlnLmluaXQgZmlsbDojZmZmZmZmLHN0cm9rZTojMzMzLHN0cm9rZS13aWR0aDoxcHgsZm9udC1zaXplOjE4cHgsZm9udC13ZWlnaHQ6NTAwLHRleHQtYWxpZ246IGNlbnRlclxuICAgIHN0eWxlIHNjcmlwdHMgZmlsbDojZmZmZmZmLHN0cm9rZTojMzMzLHN0cm9rZS13aWR0aDoxcHgsZm9udC1zaXplOjE4cHgsZm9udC13ZWlnaHQ6NTAwLHRleHQtYWxpZ246IGNlbnRlclxuICAgIHN0eWxlIHNldHBhdGhzLnNoIGZpbGw6I2ZmZmZmZixzdHJva2U6IzMzMyxzdHJva2Utd2lkdGg6MXB4LGZvbnQtc2l6ZToxOHB4LGZvbnQtd2VpZ2h0OjUwMCx0ZXh0LWFsaWduOiBjZW50ZXJcbiAgICAgXG4gICAgIiwibWVybWFpZCI6IntcbiAgXCJkaWFncmFtTWFyZ2luWFwiOiA1MCxcbiAgXCJkaWFncmFtTWFyZ2luWVwiOiAxMCxcbiAgXCJib3hUZXh0TWFyZ2luXCI6IDUsXG4gIFwibm90ZU1hcmdpblwiOiAxMCxcbiAgXCJtZXNzYWdlTWFyZ2luXCI6IDM1LFxuICBcIm1pcnJvckFjdG9yc1wiOiB0cnVlLFxuICBcInRoZW1lXCI6IFwiZGVmYXVsdFwiXG59IiwidXBkYXRlRWRpdG9yIjpmYWxzZSwiYXV0b1N5bmMiOnRydWUsInVwZGF0ZURpYWdyYW0iOmZhbHNlfQ)
    

**Check out the repository [wiki]() for more information.**
